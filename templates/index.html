<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Results</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header>
            <h1>Cyber-Security Incident Response Platform</h1>
        </header>

        <!-- Incidents Overview Section -->
        <div class="main-content">
            <div class="section overview">
                <h2>Incidents Overview</h2>
                <p>Incidents Detected: {{ predictions|length }}</p>
                <p>Incidents Mitigated: {{ incidents_mitigated }}</p>
            </div>

            <!-- Bar Chart Section -->
            <div class="section">
                <h2>Incident Response Bar Chart</h2>
                <div id="bar-chart">
                    <canvas id="predictionChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
        <div class="incidents-log">
            <h2>Incident Logs</h2>
            <table class="table table-bordered mt-3">
                <thead>
                    <tr>
                        <th>Incident Type</th>
                        <th>Status</th>
                        <th>Timestamp</th>
                    </tr>
                </thead>
                <tbody>
                    {% for incident in incidents %}
                    <tr>
                        <td>{{ incident.type }}</td>
                        <td>{{ incident.status }}</td>
                        <td>{{ incident.timestamp }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Prediction Details Section -->
        <div class="table-container section">
            <h2>Prediction Details</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Actual Label</th>
                        <th>Predicted Label</th>
                    </tr>
                </thead>
                <tbody>
                    {% for prediction in predictions %}
                    <tr>
                        <td>{{ prediction[0] }}</td>
                        <td>{{ prediction[1] }}</td>
                        <td>{{ prediction[2] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- DDoS Prediction Results Section -->
        <div class="table-container section">
            <h2>DDoS Prediction Results</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Traffic Rate</th>
                        <th>Prediction</th>
                    </tr>
                </thead>
                <tbody>
                    {% for prediction in predictions %}
                    <tr>
                        <td>{{ prediction.timestamp }}</td>
                        <td>{{ prediction.traffic_rate }}</td>
                        <td>{{ "Attack Detected" if prediction.prediction == 1 else "Normal Traffic" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <footer>
            &copy; 2024 Cyber Security Platform
        </footer>
    </div>

    <!-- Chart Script -->
    <script>
        var predictionData = {{ prediction_summary | tojson }};
        var labels = [];
        var correctData = [];
        var wrongData = [];

        predictionData.forEach(function(item) {
            labels.push('Actual: ' + item[0]);   // actual values
            correctData.push(item[1]);           // correct predictions
            wrongData.push(item[2]);             // wrong predictions
        });

        var ctx = document.getElementById('predictionChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Correct Predictions',
                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                        data: correctData
                    },
                    {
                        label: 'Wrong Predictions',
                        backgroundColor: 'rgba(255, 99, 132, 0.7)',
                        data: wrongData
                    }
                ]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
</body>
</html>
